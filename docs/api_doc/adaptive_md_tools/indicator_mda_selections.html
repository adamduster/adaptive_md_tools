<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.6.2" />
<title>adaptive_md_tools.indicator_mda_selections API documentation</title>
<meta name="description" content="This module contains classes for selecting donors, acceptors, and transferring
protons for the indicator classes in indicator.py â€¦" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase;cursor:pointer}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>adaptive_md_tools.indicator_mda_selections</code></h1>
</header>
<section id="section-intro">
<p>This module contains classes for selecting donors, acceptors, and transferring
protons for the indicator classes in indicator.py.</p>
<p>All of the selections are for an MDAnalysis universe.</p>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">#!/usr/bin/env python
&#34;&#34;&#34;
This module contains classes for selecting donors, acceptors, and transferring
protons for the indicator classes in indicator.py.

All of the selections are for an MDAnalysis universe.
&#34;&#34;&#34;
import warnings


class Selections:
    &#34;&#34;&#34;
    This is the base selection class. It contains functionality for the
    mCEC, original indicator, and the new best indicator method (indicator B in
    the paper)
    &#34;&#34;&#34;
    def __init__(self, u, all_u, proton_types, acceptor_types, rlist,
                 donor_index=None):
        &#34;&#34;&#34;

        Parameters
        ----------
        u : MDAnalysis.universe object
            The MDA universe object without any proton indicator in it
        all_u: MDAnalysis.universe object
            The MDA universe object with the proton indicator appended to the
            end
        proton_types: list of str
            A list of atom types corresponding to the protons that qualify for
            the indicator calculations. Protons not in this list that are
            connected to the donor residue will be ignored
        acceptor_types: list of str
            A list of atom types corresponding to the acceptors that qualify for
            the indicator calculations.
        rlist: float
            Search radius for looking for acceptor molecules
        donor_index:
            1-based index for setting the initial donor of the selection.
            If this is present, the donor selection will automatically be
            set up. Otherwise, it is necessary to manually call another
            subroutine to select it

        Returns
        -------

        &#34;&#34;&#34;
        #initialize acceptor selection string
        self.acc_string = &#34;type %s&#34; % acceptor_types[0]
        for acc in range(1, len(acceptor_types)):
            self.acc_string += &#34; or type %s&#34; % acceptor_types[acc]

        # initialize proton selection string
        self.proton_string = &#34;type %s&#34; % proton_types[0]
        for i in range(1, len(proton_types)):
            self.proton_string += &#34; or type %s&#34; % proton_types[i]

        # selection for donor
        self.d = None
        if donor_index:
            self.set_donor(u, donor_index)

        # selection for acceptor
        self.a = None

        # selection for hydrogen
        self.h = None

        # rlist parameter
        self.rlist = rlist
        # selection for system without indicator
        self.sys = None
        # selection for system with indicator
        self.all = None
        # Initialize selections
        self.reset_universe_selections(u, all_u)

    def set_donor(self, u, donor_ind):
        &#34;&#34;&#34;
        Set the new donor(s) from a 1-based donor atom index.

        This will set the donor selection to a list of atoms that have:
            1. the same *resnum* as the input parameter donor_ind
            2. atom types from the self.acc_string variable

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        donor_ind: int
            1-based integer to base donor search from

        Returns
        -------

        &#34;&#34;&#34;
        self.d = u.select_atoms(&#34;same resnum as bynum %d&#34; % donor_ind)
        self.d = self.d.select_atoms(self.acc_string)
        if not self.d:
            print(&#34;Error selecting donor. Are the atom types listed correctly in the input file?&#34;)
            print(&#34;Selection string:&#34;)
            print(&#34;same resnum as bynum %d&#34; % donor_ind)
            raise KeyError

    def set_acc(self, u):
        &#34;&#34;&#34;
        Use the MDAnalysis selection tools to find the acceptors within
        self.rlist of the donor selection.

        Note:
            1. this selects atoms around all donor atoms in the self.d selection
            2. this deselects atoms that have the same resnum as the donor

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        &#34;&#34;&#34;
        if not self.d:
            print(&#34;Error can&#39;t select acceptors because there is no donor&#34;)
            raise LookupError

        d_res = self.d.resids[0]
        sel_str = (&#34;(({2}) and (around {0} (&#34;
            + &#34;bynum {1})))&#34;).format(self.rlist, self.d.indices[0]+1, self.acc_string)
        num_d = self.d.indices.size
        for d in range(1, num_d):
            sel_str += &#34; or (({2}) and (around {0} (&#34; \
                &#34;bynum {1})))&#34;.format(self.rlist, self.d.indices[d]+1, self.acc_string)
        self.a = u.select_atoms(sel_str)
        self.a = self.a.select_atoms(&#34;not resnum %d &#34; % d_res)

    def set_original_acc(self, u):
        &#34;&#34;&#34;
        Uses the MDAnalysis selection tools to select acceptors within
        self.rlist of the list of self.d

        This does not deselect atoms that are in the same residue as the donor.

        It is called set_original_acc as it follows the rules of the original
        proton indicator.

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        &#34;&#34;&#34;
        sel_str = (&#34;(({2}) and (around {0} (&#34;
            + &#34;bynum {1})))&#34;).format(self.rlist, self.d.indices[0]+1, self.acc_string)
        num_d = self.d.indices.size
        for d in range(1, num_d):
            sel_str += &#34; or (({2}) and (around {0} (&#34; \
                &#34;bynum {1})))&#34;.format(self.rlist, self.d.indices[d]+1, self.acc_string)
        self.a = u.select_atoms(sel_str)
        self.a = self.a.select_atoms(&#34;not bynum {0} &#34;.format(self.d.indices[0]+1))

    def set_proton(self, u, atom_ind):
        &#34;&#34;&#34;
        Select protons bonded to the atom given by atom_ind

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        atom_ind: int
            1-based integer to base donor search from
        &#34;&#34;&#34;
        self.h = u.select_atoms(
            &#34;({1}) and bonded (bynum {0})&#34;.format(atom_ind, self.proton_string))

    def set_dah(self, u, donor_ind):
        &#34;&#34;&#34;
        Convenience function for setting the donor, then calculating the
        acceptor and proton selections.

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        donor_ind: int
            1-based integer to base donor search from
        &#34;&#34;&#34;
        self.set_donor(u, donor_ind)
        self.set_acc(u)
        self.set_proton(u, donor_ind)

    def reset_universe_selections(self, u, all_u):
        &#34;&#34;&#34;
        Selects all of the atoms in the universe and universe with indicator.

        Parameters
        ----------
        u : MDAnalysis.universe object
            The MDA universe object without any proton indicator in it
        all_u: MDAnalysis.universe object
            The MDA universe object with the proton indicator appended to the
            end
        &#34;&#34;&#34;
        self.sys = u.select_atoms(&#34;all&#34;)
        self.all = all_u.select_atoms(&#34;all&#34;)

    def reset_all(self, u, all_u, donor_ind):
        &#34;&#34;&#34;
        Convenience function for resetting the universe and indicator
        selections. Calls the reset universe function and then sets the donor,
        acceptor, and protons.

        Parameters
        ----------
        u : MDAnalysis.universe object
            The MDA universe object without any proton indicator in it
        all_u: MDAnalysis.universe object
            The MDA universe object with the proton indicator appended to the
            end
        donor_ind: int
            1-based integer to base donor search from
        &#34;&#34;&#34;
        self.set_dah(u, donor_ind)
        self.reset_universe_selections(u, all_u)

    def set_one_donor(self, u, donor_ind):
        &#34;&#34;&#34;
        Set the donor to be an individual atom.

        This is in contrast to the set_donor function which selects multiple
        atoms with the same resnum.

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        donor_ind: int
            1-based integer to base donor search from
        &#34;&#34;&#34;
        self.d = u.select_atoms(&#34;bynum {0}&#34;.format(donor_ind))

    def set_all_acc(self, u):
        &#34;&#34;&#34;
        Select all of the donor/acceptor atoms in the universe.
        This is used in conjunction with mCEC calculations.

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        &#34;&#34;&#34;
        return u.select_atoms(self.acc_string)

    def set_all_protons(self, u):
        &#34;&#34;&#34;
        Select all of the protons in the universe.
        This is used in conjunction with mCEC calculations.

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        &#34;&#34;&#34;
        return u.select_atoms(self.proton_string)


class SelectionsInd1(Selections):
    &#34;&#34;&#34;
    This is the selection class for indicator A in the paper.

    Here, we need to select all protons in the donor group. In
    the program, we just pretend the COM is the donor position
    and use this for the H positions.


    &#34;&#34;&#34;
    def __init__(self, u, all_u, proton_types, acceptor_types, rlist,
                 donor_index=None):
        &#34;&#34;&#34;
        Initialize the selection class

        Parameters
        ----------
        u : MDAnalysis.universe object
            The MDA universe object without any proton indicator in it
        all_u: MDAnalysis.universe object
            The MDA universe object with the proton indicator appended to the
            end
        proton_types: list of str
            A list of atom types corresponding to the protons that qualify for
            the indicator calculations. Protons not in this list that are
            connected to the donor residue will be ignored
        acceptor_types: list of str
            A list of atom types corresponding to the acceptors that qualify for
            the indicator calculations.
        rlist: float
            Search radius for looking for acceptor molecules
        donor_index:
            1-based index for setting the initial donor of the selection.
            If this is present, the donor selection will automatically be
            set up. Otherwise, it is necessary to manually call another
            subroutine to select it

        &#34;&#34;&#34;
        Selections.__init__(self, u, all_u, proton_types, acceptor_types, rlist,
                            donor_index=donor_index)

    def set_proton(self, u, donor_ind):
        &#34;&#34;&#34;
        Set all of the protons bonded do the donor group.

        Notes
        -----
        The below code suffers from some bug in glu-w where it selects properly
        when  &#39;( bonded bynum 7 or bonded bynum 5 )&#39;
        but not
             &#39;( bonded bynum 5 or bonded bynum 7 )&#39;

        I think I just had to switch the order in the input file...

        It can also run into a bug if two donors are bonded to proton

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        donor_ind: int
            1-based integer to base donor search from

        Returns
        -------

        &#34;&#34;&#34;
        dinds = self.d.indices + 1
        self.h = u.select_atoms(&#39;bonded bynum {0}&#39;.format(dinds[0]))
        for i in range(1, len(dinds)):
            self.h += u.select_atoms(&#39;bonded bynum {0}&#39;.format(dinds[i]))
        self.h = self.h.select_atoms(&#34;{0}&#34;.format(self.proton_string))


class SelectionsInd2(Selections):
    &#34;&#34;&#34;
    The selection class for indicator 2.

    This class is experimental and may not work as expected due to the fact that
    there was no congnizent equation for indicator 2.
    &#34;&#34;&#34;
    def __init__(self, u, all_u, proton_types, acceptor_types, rlist, donor_index=None, a=None):
        Selections.__init__(self, u, all_u, proton_types, acceptor_types, rlist, donor_index=donor_index, a=a)
        warnings.warn(&#34;SelectionInd2 class is not implemented well&#34;)
        raise NotImplementedError

    def set_donors(self, u, donor_ind):
        self.d = u.select_atoms(&#34;same resnum as bynum %d&#34; % donor_ind)
        self.d = self.d.select_atoms(self.acc_string)

    def set_donor(self, u, donor_ind):
        self.d = u.select_atoms(&#34;bynum %d&#34; % donor_ind)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="adaptive_md_tools.indicator_mda_selections.Selections"><code class="flex name class">
<span>class <span class="ident">Selections</span></span>
<span>(</span><span>u, all_u, proton_types, acceptor_types, rlist, donor_index=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This is the base selection class. It contains functionality for the
mCEC, original indicator, and the new best indicator method (indicator B in
the paper)</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>u</code></strong> :&ensp;<code>MDAnalysis.universe</code> <code>object</code></dt>
<dd>The MDA universe object without any proton indicator in it</dd>
<dt><strong><code>all_u</code></strong> :&ensp;<code>MDAnalysis.universe</code> <code>object</code></dt>
<dd>The MDA universe object with the proton indicator appended to the
end</dd>
<dt><strong><code>proton_types</code></strong> :&ensp;<code>list</code> of <code>str</code></dt>
<dd>A list of atom types corresponding to the protons that qualify for
the indicator calculations. Protons not in this list that are
connected to the donor residue will be ignored</dd>
<dt><strong><code>acceptor_types</code></strong> :&ensp;<code>list</code> of <code>str</code></dt>
<dd>A list of atom types corresponding to the acceptors that qualify for
the indicator calculations.</dd>
<dt><strong><code>rlist</code></strong> :&ensp;<code>float</code></dt>
<dd>Search radius for looking for acceptor molecules</dd>
</dl>
<p>donor_index:
1-based index for setting the initial donor of the selection.
If this is present, the donor selection will automatically be
set up. Otherwise, it is necessary to manually call another
subroutine to select it</p>
<h2 id="returns">Returns</h2></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">class Selections:
    &#34;&#34;&#34;
    This is the base selection class. It contains functionality for the
    mCEC, original indicator, and the new best indicator method (indicator B in
    the paper)
    &#34;&#34;&#34;
    def __init__(self, u, all_u, proton_types, acceptor_types, rlist,
                 donor_index=None):
        &#34;&#34;&#34;

        Parameters
        ----------
        u : MDAnalysis.universe object
            The MDA universe object without any proton indicator in it
        all_u: MDAnalysis.universe object
            The MDA universe object with the proton indicator appended to the
            end
        proton_types: list of str
            A list of atom types corresponding to the protons that qualify for
            the indicator calculations. Protons not in this list that are
            connected to the donor residue will be ignored
        acceptor_types: list of str
            A list of atom types corresponding to the acceptors that qualify for
            the indicator calculations.
        rlist: float
            Search radius for looking for acceptor molecules
        donor_index:
            1-based index for setting the initial donor of the selection.
            If this is present, the donor selection will automatically be
            set up. Otherwise, it is necessary to manually call another
            subroutine to select it

        Returns
        -------

        &#34;&#34;&#34;
        #initialize acceptor selection string
        self.acc_string = &#34;type %s&#34; % acceptor_types[0]
        for acc in range(1, len(acceptor_types)):
            self.acc_string += &#34; or type %s&#34; % acceptor_types[acc]

        # initialize proton selection string
        self.proton_string = &#34;type %s&#34; % proton_types[0]
        for i in range(1, len(proton_types)):
            self.proton_string += &#34; or type %s&#34; % proton_types[i]

        # selection for donor
        self.d = None
        if donor_index:
            self.set_donor(u, donor_index)

        # selection for acceptor
        self.a = None

        # selection for hydrogen
        self.h = None

        # rlist parameter
        self.rlist = rlist
        # selection for system without indicator
        self.sys = None
        # selection for system with indicator
        self.all = None
        # Initialize selections
        self.reset_universe_selections(u, all_u)

    def set_donor(self, u, donor_ind):
        &#34;&#34;&#34;
        Set the new donor(s) from a 1-based donor atom index.

        This will set the donor selection to a list of atoms that have:
            1. the same *resnum* as the input parameter donor_ind
            2. atom types from the self.acc_string variable

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        donor_ind: int
            1-based integer to base donor search from

        Returns
        -------

        &#34;&#34;&#34;
        self.d = u.select_atoms(&#34;same resnum as bynum %d&#34; % donor_ind)
        self.d = self.d.select_atoms(self.acc_string)
        if not self.d:
            print(&#34;Error selecting donor. Are the atom types listed correctly in the input file?&#34;)
            print(&#34;Selection string:&#34;)
            print(&#34;same resnum as bynum %d&#34; % donor_ind)
            raise KeyError

    def set_acc(self, u):
        &#34;&#34;&#34;
        Use the MDAnalysis selection tools to find the acceptors within
        self.rlist of the donor selection.

        Note:
            1. this selects atoms around all donor atoms in the self.d selection
            2. this deselects atoms that have the same resnum as the donor

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        &#34;&#34;&#34;
        if not self.d:
            print(&#34;Error can&#39;t select acceptors because there is no donor&#34;)
            raise LookupError

        d_res = self.d.resids[0]
        sel_str = (&#34;(({2}) and (around {0} (&#34;
            + &#34;bynum {1})))&#34;).format(self.rlist, self.d.indices[0]+1, self.acc_string)
        num_d = self.d.indices.size
        for d in range(1, num_d):
            sel_str += &#34; or (({2}) and (around {0} (&#34; \
                &#34;bynum {1})))&#34;.format(self.rlist, self.d.indices[d]+1, self.acc_string)
        self.a = u.select_atoms(sel_str)
        self.a = self.a.select_atoms(&#34;not resnum %d &#34; % d_res)

    def set_original_acc(self, u):
        &#34;&#34;&#34;
        Uses the MDAnalysis selection tools to select acceptors within
        self.rlist of the list of self.d

        This does not deselect atoms that are in the same residue as the donor.

        It is called set_original_acc as it follows the rules of the original
        proton indicator.

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        &#34;&#34;&#34;
        sel_str = (&#34;(({2}) and (around {0} (&#34;
            + &#34;bynum {1})))&#34;).format(self.rlist, self.d.indices[0]+1, self.acc_string)
        num_d = self.d.indices.size
        for d in range(1, num_d):
            sel_str += &#34; or (({2}) and (around {0} (&#34; \
                &#34;bynum {1})))&#34;.format(self.rlist, self.d.indices[d]+1, self.acc_string)
        self.a = u.select_atoms(sel_str)
        self.a = self.a.select_atoms(&#34;not bynum {0} &#34;.format(self.d.indices[0]+1))

    def set_proton(self, u, atom_ind):
        &#34;&#34;&#34;
        Select protons bonded to the atom given by atom_ind

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        atom_ind: int
            1-based integer to base donor search from
        &#34;&#34;&#34;
        self.h = u.select_atoms(
            &#34;({1}) and bonded (bynum {0})&#34;.format(atom_ind, self.proton_string))

    def set_dah(self, u, donor_ind):
        &#34;&#34;&#34;
        Convenience function for setting the donor, then calculating the
        acceptor and proton selections.

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        donor_ind: int
            1-based integer to base donor search from
        &#34;&#34;&#34;
        self.set_donor(u, donor_ind)
        self.set_acc(u)
        self.set_proton(u, donor_ind)

    def reset_universe_selections(self, u, all_u):
        &#34;&#34;&#34;
        Selects all of the atoms in the universe and universe with indicator.

        Parameters
        ----------
        u : MDAnalysis.universe object
            The MDA universe object without any proton indicator in it
        all_u: MDAnalysis.universe object
            The MDA universe object with the proton indicator appended to the
            end
        &#34;&#34;&#34;
        self.sys = u.select_atoms(&#34;all&#34;)
        self.all = all_u.select_atoms(&#34;all&#34;)

    def reset_all(self, u, all_u, donor_ind):
        &#34;&#34;&#34;
        Convenience function for resetting the universe and indicator
        selections. Calls the reset universe function and then sets the donor,
        acceptor, and protons.

        Parameters
        ----------
        u : MDAnalysis.universe object
            The MDA universe object without any proton indicator in it
        all_u: MDAnalysis.universe object
            The MDA universe object with the proton indicator appended to the
            end
        donor_ind: int
            1-based integer to base donor search from
        &#34;&#34;&#34;
        self.set_dah(u, donor_ind)
        self.reset_universe_selections(u, all_u)

    def set_one_donor(self, u, donor_ind):
        &#34;&#34;&#34;
        Set the donor to be an individual atom.

        This is in contrast to the set_donor function which selects multiple
        atoms with the same resnum.

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        donor_ind: int
            1-based integer to base donor search from
        &#34;&#34;&#34;
        self.d = u.select_atoms(&#34;bynum {0}&#34;.format(donor_ind))

    def set_all_acc(self, u):
        &#34;&#34;&#34;
        Select all of the donor/acceptor atoms in the universe.
        This is used in conjunction with mCEC calculations.

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        &#34;&#34;&#34;
        return u.select_atoms(self.acc_string)

    def set_all_protons(self, u):
        &#34;&#34;&#34;
        Select all of the protons in the universe.
        This is used in conjunction with mCEC calculations.

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        &#34;&#34;&#34;
        return u.select_atoms(self.proton_string)</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="adaptive_md_tools.indicator_mda_selections.SelectionsInd1" href="#adaptive_md_tools.indicator_mda_selections.SelectionsInd1">SelectionsInd1</a></li>
<li><a title="adaptive_md_tools.indicator_mda_selections.SelectionsInd2" href="#adaptive_md_tools.indicator_mda_selections.SelectionsInd2">SelectionsInd2</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="adaptive_md_tools.indicator_mda_selections.Selections.reset_all"><code class="name flex">
<span>def <span class="ident">reset_all</span></span>(<span>self, u, all_u, donor_ind)</span>
</code></dt>
<dd>
<section class="desc"><p>Convenience function for resetting the universe and indicator
selections. Calls the reset universe function and then sets the donor,
acceptor, and protons.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>u</code></strong> :&ensp;<code>MDAnalysis.universe</code> <code>object</code></dt>
<dd>The MDA universe object without any proton indicator in it</dd>
<dt><strong><code>all_u</code></strong> :&ensp;<code>MDAnalysis.universe</code> <code>object</code></dt>
<dd>The MDA universe object with the proton indicator appended to the
end</dd>
<dt><strong><code>donor_ind</code></strong> :&ensp;<code>int</code></dt>
<dd>1-based integer to base donor search from</dd>
</dl></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">def reset_all(self, u, all_u, donor_ind):
    &#34;&#34;&#34;
    Convenience function for resetting the universe and indicator
    selections. Calls the reset universe function and then sets the donor,
    acceptor, and protons.

    Parameters
    ----------
    u : MDAnalysis.universe object
        The MDA universe object without any proton indicator in it
    all_u: MDAnalysis.universe object
        The MDA universe object with the proton indicator appended to the
        end
    donor_ind: int
        1-based integer to base donor search from
    &#34;&#34;&#34;
    self.set_dah(u, donor_ind)
    self.reset_universe_selections(u, all_u)</code></pre>
</details>
</dd>
<dt id="adaptive_md_tools.indicator_mda_selections.Selections.reset_universe_selections"><code class="name flex">
<span>def <span class="ident">reset_universe_selections</span></span>(<span>self, u, all_u)</span>
</code></dt>
<dd>
<section class="desc"><p>Selects all of the atoms in the universe and universe with indicator.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>u</code></strong> :&ensp;<code>MDAnalysis.universe</code> <code>object</code></dt>
<dd>The MDA universe object without any proton indicator in it</dd>
<dt><strong><code>all_u</code></strong> :&ensp;<code>MDAnalysis.universe</code> <code>object</code></dt>
<dd>The MDA universe object with the proton indicator appended to the
end</dd>
</dl></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">def reset_universe_selections(self, u, all_u):
    &#34;&#34;&#34;
    Selects all of the atoms in the universe and universe with indicator.

    Parameters
    ----------
    u : MDAnalysis.universe object
        The MDA universe object without any proton indicator in it
    all_u: MDAnalysis.universe object
        The MDA universe object with the proton indicator appended to the
        end
    &#34;&#34;&#34;
    self.sys = u.select_atoms(&#34;all&#34;)
    self.all = all_u.select_atoms(&#34;all&#34;)</code></pre>
</details>
</dd>
<dt id="adaptive_md_tools.indicator_mda_selections.Selections.set_acc"><code class="name flex">
<span>def <span class="ident">set_acc</span></span>(<span>self, u)</span>
</code></dt>
<dd>
<section class="desc"><p>Use the MDAnalysis selection tools to find the acceptors within
self.rlist of the donor selection.</p>
<h2 id="note">Note</h2>
<ol>
<li>this selects atoms around all donor atoms in the self.d selection</li>
<li>this deselects atoms that have the same resnum as the donor
Parameters</li>
</ol>
<hr>
<dl>
<dt><strong><code>u</code></strong> :&ensp;<code>MDAnalysis.universe</code></dt>
<dd>MDA universe to search for atoms within</dd>
</dl></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">def set_acc(self, u):
    &#34;&#34;&#34;
    Use the MDAnalysis selection tools to find the acceptors within
    self.rlist of the donor selection.

    Note:
        1. this selects atoms around all donor atoms in the self.d selection
        2. this deselects atoms that have the same resnum as the donor

    Parameters
    ----------
    u : MDAnalysis.universe
        MDA universe to search for atoms within
    &#34;&#34;&#34;
    if not self.d:
        print(&#34;Error can&#39;t select acceptors because there is no donor&#34;)
        raise LookupError

    d_res = self.d.resids[0]
    sel_str = (&#34;(({2}) and (around {0} (&#34;
        + &#34;bynum {1})))&#34;).format(self.rlist, self.d.indices[0]+1, self.acc_string)
    num_d = self.d.indices.size
    for d in range(1, num_d):
        sel_str += &#34; or (({2}) and (around {0} (&#34; \
            &#34;bynum {1})))&#34;.format(self.rlist, self.d.indices[d]+1, self.acc_string)
    self.a = u.select_atoms(sel_str)
    self.a = self.a.select_atoms(&#34;not resnum %d &#34; % d_res)</code></pre>
</details>
</dd>
<dt id="adaptive_md_tools.indicator_mda_selections.Selections.set_all_acc"><code class="name flex">
<span>def <span class="ident">set_all_acc</span></span>(<span>self, u)</span>
</code></dt>
<dd>
<section class="desc"><p>Select all of the donor/acceptor atoms in the universe.
This is used in conjunction with mCEC calculations.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>u</code></strong> :&ensp;<code>MDAnalysis.universe</code></dt>
<dd>MDA universe to search for atoms within</dd>
</dl></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">def set_all_acc(self, u):
    &#34;&#34;&#34;
    Select all of the donor/acceptor atoms in the universe.
    This is used in conjunction with mCEC calculations.

    Parameters
    ----------
    u : MDAnalysis.universe
        MDA universe to search for atoms within
    &#34;&#34;&#34;
    return u.select_atoms(self.acc_string)</code></pre>
</details>
</dd>
<dt id="adaptive_md_tools.indicator_mda_selections.Selections.set_all_protons"><code class="name flex">
<span>def <span class="ident">set_all_protons</span></span>(<span>self, u)</span>
</code></dt>
<dd>
<section class="desc"><p>Select all of the protons in the universe.
This is used in conjunction with mCEC calculations.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>u</code></strong> :&ensp;<code>MDAnalysis.universe</code></dt>
<dd>MDA universe to search for atoms within</dd>
</dl></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">def set_all_protons(self, u):
    &#34;&#34;&#34;
    Select all of the protons in the universe.
    This is used in conjunction with mCEC calculations.

    Parameters
    ----------
    u : MDAnalysis.universe
        MDA universe to search for atoms within
    &#34;&#34;&#34;
    return u.select_atoms(self.proton_string)</code></pre>
</details>
</dd>
<dt id="adaptive_md_tools.indicator_mda_selections.Selections.set_dah"><code class="name flex">
<span>def <span class="ident">set_dah</span></span>(<span>self, u, donor_ind)</span>
</code></dt>
<dd>
<section class="desc"><p>Convenience function for setting the donor, then calculating the
acceptor and proton selections.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>u</code></strong> :&ensp;<code>MDAnalysis.universe</code></dt>
<dd>MDA universe to search for atoms within</dd>
<dt><strong><code>donor_ind</code></strong> :&ensp;<code>int</code></dt>
<dd>1-based integer to base donor search from</dd>
</dl></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">def set_dah(self, u, donor_ind):
    &#34;&#34;&#34;
    Convenience function for setting the donor, then calculating the
    acceptor and proton selections.

    Parameters
    ----------
    u : MDAnalysis.universe
        MDA universe to search for atoms within
    donor_ind: int
        1-based integer to base donor search from
    &#34;&#34;&#34;
    self.set_donor(u, donor_ind)
    self.set_acc(u)
    self.set_proton(u, donor_ind)</code></pre>
</details>
</dd>
<dt id="adaptive_md_tools.indicator_mda_selections.Selections.set_donor"><code class="name flex">
<span>def <span class="ident">set_donor</span></span>(<span>self, u, donor_ind)</span>
</code></dt>
<dd>
<section class="desc"><p>Set the new donor(s) from a 1-based donor atom index.</p>
<p>This will set the donor selection to a list of atoms that have:
1. the same <em>resnum</em> as the input parameter donor_ind
2. atom types from the self.acc_string variable</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>u</code></strong> :&ensp;<code>MDAnalysis.universe</code></dt>
<dd>MDA universe to search for atoms within</dd>
<dt><strong><code>donor_ind</code></strong> :&ensp;<code>int</code></dt>
<dd>1-based integer to base donor search from</dd>
</dl>
<h2 id="returns">Returns</h2></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">def set_donor(self, u, donor_ind):
    &#34;&#34;&#34;
    Set the new donor(s) from a 1-based donor atom index.

    This will set the donor selection to a list of atoms that have:
        1. the same *resnum* as the input parameter donor_ind
        2. atom types from the self.acc_string variable

    Parameters
    ----------
    u : MDAnalysis.universe
        MDA universe to search for atoms within
    donor_ind: int
        1-based integer to base donor search from

    Returns
    -------

    &#34;&#34;&#34;
    self.d = u.select_atoms(&#34;same resnum as bynum %d&#34; % donor_ind)
    self.d = self.d.select_atoms(self.acc_string)
    if not self.d:
        print(&#34;Error selecting donor. Are the atom types listed correctly in the input file?&#34;)
        print(&#34;Selection string:&#34;)
        print(&#34;same resnum as bynum %d&#34; % donor_ind)
        raise KeyError</code></pre>
</details>
</dd>
<dt id="adaptive_md_tools.indicator_mda_selections.Selections.set_one_donor"><code class="name flex">
<span>def <span class="ident">set_one_donor</span></span>(<span>self, u, donor_ind)</span>
</code></dt>
<dd>
<section class="desc"><p>Set the donor to be an individual atom.</p>
<p>This is in contrast to the set_donor function which selects multiple
atoms with the same resnum.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>u</code></strong> :&ensp;<code>MDAnalysis.universe</code></dt>
<dd>MDA universe to search for atoms within</dd>
<dt><strong><code>donor_ind</code></strong> :&ensp;<code>int</code></dt>
<dd>1-based integer to base donor search from</dd>
</dl></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">def set_one_donor(self, u, donor_ind):
    &#34;&#34;&#34;
    Set the donor to be an individual atom.

    This is in contrast to the set_donor function which selects multiple
    atoms with the same resnum.

    Parameters
    ----------
    u : MDAnalysis.universe
        MDA universe to search for atoms within
    donor_ind: int
        1-based integer to base donor search from
    &#34;&#34;&#34;
    self.d = u.select_atoms(&#34;bynum {0}&#34;.format(donor_ind))</code></pre>
</details>
</dd>
<dt id="adaptive_md_tools.indicator_mda_selections.Selections.set_original_acc"><code class="name flex">
<span>def <span class="ident">set_original_acc</span></span>(<span>self, u)</span>
</code></dt>
<dd>
<section class="desc"><p>Uses the MDAnalysis selection tools to select acceptors within
self.rlist of the list of self.d</p>
<p>This does not deselect atoms that are in the same residue as the donor.</p>
<p>It is called set_original_acc as it follows the rules of the original
proton indicator.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>u</code></strong> :&ensp;<code>MDAnalysis.universe</code></dt>
<dd>MDA universe to search for atoms within</dd>
</dl></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">def set_original_acc(self, u):
    &#34;&#34;&#34;
    Uses the MDAnalysis selection tools to select acceptors within
    self.rlist of the list of self.d

    This does not deselect atoms that are in the same residue as the donor.

    It is called set_original_acc as it follows the rules of the original
    proton indicator.

    Parameters
    ----------
    u : MDAnalysis.universe
        MDA universe to search for atoms within
    &#34;&#34;&#34;
    sel_str = (&#34;(({2}) and (around {0} (&#34;
        + &#34;bynum {1})))&#34;).format(self.rlist, self.d.indices[0]+1, self.acc_string)
    num_d = self.d.indices.size
    for d in range(1, num_d):
        sel_str += &#34; or (({2}) and (around {0} (&#34; \
            &#34;bynum {1})))&#34;.format(self.rlist, self.d.indices[d]+1, self.acc_string)
    self.a = u.select_atoms(sel_str)
    self.a = self.a.select_atoms(&#34;not bynum {0} &#34;.format(self.d.indices[0]+1))</code></pre>
</details>
</dd>
<dt id="adaptive_md_tools.indicator_mda_selections.Selections.set_proton"><code class="name flex">
<span>def <span class="ident">set_proton</span></span>(<span>self, u, atom_ind)</span>
</code></dt>
<dd>
<section class="desc"><p>Select protons bonded to the atom given by atom_ind</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>u</code></strong> :&ensp;<code>MDAnalysis.universe</code></dt>
<dd>MDA universe to search for atoms within</dd>
<dt><strong><code>atom_ind</code></strong> :&ensp;<code>int</code></dt>
<dd>1-based integer to base donor search from</dd>
</dl></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">def set_proton(self, u, atom_ind):
    &#34;&#34;&#34;
    Select protons bonded to the atom given by atom_ind

    Parameters
    ----------
    u : MDAnalysis.universe
        MDA universe to search for atoms within
    atom_ind: int
        1-based integer to base donor search from
    &#34;&#34;&#34;
    self.h = u.select_atoms(
        &#34;({1}) and bonded (bynum {0})&#34;.format(atom_ind, self.proton_string))</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="adaptive_md_tools.indicator_mda_selections.SelectionsInd1"><code class="flex name class">
<span>class <span class="ident">SelectionsInd1</span></span>
<span>(</span><span>u, all_u, proton_types, acceptor_types, rlist, donor_index=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This is the selection class for indicator A in the paper.</p>
<p>Here, we need to select all protons in the donor group. In
the program, we just pretend the COM is the donor position
and use this for the H positions.</p>
<p>Initialize the selection class</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>u</code></strong> :&ensp;<code>MDAnalysis.universe</code> <code>object</code></dt>
<dd>The MDA universe object without any proton indicator in it</dd>
<dt><strong><code>all_u</code></strong> :&ensp;<code>MDAnalysis.universe</code> <code>object</code></dt>
<dd>The MDA universe object with the proton indicator appended to the
end</dd>
<dt><strong><code>proton_types</code></strong> :&ensp;<code>list</code> of <code>str</code></dt>
<dd>A list of atom types corresponding to the protons that qualify for
the indicator calculations. Protons not in this list that are
connected to the donor residue will be ignored</dd>
<dt><strong><code>acceptor_types</code></strong> :&ensp;<code>list</code> of <code>str</code></dt>
<dd>A list of atom types corresponding to the acceptors that qualify for
the indicator calculations.</dd>
<dt><strong><code>rlist</code></strong> :&ensp;<code>float</code></dt>
<dd>Search radius for looking for acceptor molecules</dd>
</dl>
<p>donor_index:
1-based index for setting the initial donor of the selection.
If this is present, the donor selection will automatically be
set up. Otherwise, it is necessary to manually call another
subroutine to select it</p></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">class SelectionsInd1(Selections):
    &#34;&#34;&#34;
    This is the selection class for indicator A in the paper.

    Here, we need to select all protons in the donor group. In
    the program, we just pretend the COM is the donor position
    and use this for the H positions.


    &#34;&#34;&#34;
    def __init__(self, u, all_u, proton_types, acceptor_types, rlist,
                 donor_index=None):
        &#34;&#34;&#34;
        Initialize the selection class

        Parameters
        ----------
        u : MDAnalysis.universe object
            The MDA universe object without any proton indicator in it
        all_u: MDAnalysis.universe object
            The MDA universe object with the proton indicator appended to the
            end
        proton_types: list of str
            A list of atom types corresponding to the protons that qualify for
            the indicator calculations. Protons not in this list that are
            connected to the donor residue will be ignored
        acceptor_types: list of str
            A list of atom types corresponding to the acceptors that qualify for
            the indicator calculations.
        rlist: float
            Search radius for looking for acceptor molecules
        donor_index:
            1-based index for setting the initial donor of the selection.
            If this is present, the donor selection will automatically be
            set up. Otherwise, it is necessary to manually call another
            subroutine to select it

        &#34;&#34;&#34;
        Selections.__init__(self, u, all_u, proton_types, acceptor_types, rlist,
                            donor_index=donor_index)

    def set_proton(self, u, donor_ind):
        &#34;&#34;&#34;
        Set all of the protons bonded do the donor group.

        Notes
        -----
        The below code suffers from some bug in glu-w where it selects properly
        when  &#39;( bonded bynum 7 or bonded bynum 5 )&#39;
        but not
             &#39;( bonded bynum 5 or bonded bynum 7 )&#39;

        I think I just had to switch the order in the input file...

        It can also run into a bug if two donors are bonded to proton

        Parameters
        ----------
        u : MDAnalysis.universe
            MDA universe to search for atoms within
        donor_ind: int
            1-based integer to base donor search from

        Returns
        -------

        &#34;&#34;&#34;
        dinds = self.d.indices + 1
        self.h = u.select_atoms(&#39;bonded bynum {0}&#39;.format(dinds[0]))
        for i in range(1, len(dinds)):
            self.h += u.select_atoms(&#39;bonded bynum {0}&#39;.format(dinds[i]))
        self.h = self.h.select_atoms(&#34;{0}&#34;.format(self.proton_string))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="adaptive_md_tools.indicator_mda_selections.Selections" href="#adaptive_md_tools.indicator_mda_selections.Selections">Selections</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="adaptive_md_tools.indicator_mda_selections.SelectionsInd1.set_proton"><code class="name flex">
<span>def <span class="ident">set_proton</span></span>(<span>self, u, donor_ind)</span>
</code></dt>
<dd>
<section class="desc"><p>Set all of the protons bonded do the donor group.</p>
<h2 id="notes">Notes</h2>
<p>The below code suffers from some bug in glu-w where it selects properly
when
'( bonded bynum 7 or bonded bynum 5 )'
but not
'( bonded bynum 5 or bonded bynum 7 )'</p>
<p>I think I just had to switch the order in the input file&hellip;</p>
<p>It can also run into a bug if two donors are bonded to proton</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>u</code></strong> :&ensp;<code>MDAnalysis.universe</code></dt>
<dd>MDA universe to search for atoms within</dd>
<dt><strong><code>donor_ind</code></strong> :&ensp;<code>int</code></dt>
<dd>1-based integer to base donor search from</dd>
</dl>
<h2 id="returns">Returns</h2></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">def set_proton(self, u, donor_ind):
    &#34;&#34;&#34;
    Set all of the protons bonded do the donor group.

    Notes
    -----
    The below code suffers from some bug in glu-w where it selects properly
    when  &#39;( bonded bynum 7 or bonded bynum 5 )&#39;
    but not
         &#39;( bonded bynum 5 or bonded bynum 7 )&#39;

    I think I just had to switch the order in the input file...

    It can also run into a bug if two donors are bonded to proton

    Parameters
    ----------
    u : MDAnalysis.universe
        MDA universe to search for atoms within
    donor_ind: int
        1-based integer to base donor search from

    Returns
    -------

    &#34;&#34;&#34;
    dinds = self.d.indices + 1
    self.h = u.select_atoms(&#39;bonded bynum {0}&#39;.format(dinds[0]))
    for i in range(1, len(dinds)):
        self.h += u.select_atoms(&#39;bonded bynum {0}&#39;.format(dinds[i]))
    self.h = self.h.select_atoms(&#34;{0}&#34;.format(self.proton_string))</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="adaptive_md_tools.indicator_mda_selections.Selections" href="#adaptive_md_tools.indicator_mda_selections.Selections">Selections</a></b></code>:
<ul class="hlist">
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.reset_all" href="#adaptive_md_tools.indicator_mda_selections.Selections.reset_all">reset_all</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.reset_universe_selections" href="#adaptive_md_tools.indicator_mda_selections.Selections.reset_universe_selections">reset_universe_selections</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_acc" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_acc">set_acc</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_all_acc" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_all_acc">set_all_acc</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_all_protons" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_all_protons">set_all_protons</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_dah" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_dah">set_dah</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_donor" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_donor">set_donor</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_one_donor" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_one_donor">set_one_donor</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_original_acc" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_original_acc">set_original_acc</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="adaptive_md_tools.indicator_mda_selections.SelectionsInd2"><code class="flex name class">
<span>class <span class="ident">SelectionsInd2</span></span>
<span>(</span><span>u, all_u, proton_types, acceptor_types, rlist, donor_index=None, a=None)</span>
</code></dt>
<dd>
<section class="desc"><p>The selection class for indicator 2.</p>
<p>This class is experimental and may not work as expected due to the fact that
there was no congnizent equation for indicator 2.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>u</code></strong> :&ensp;<code>MDAnalysis.universe</code> <code>object</code></dt>
<dd>The MDA universe object without any proton indicator in it</dd>
<dt><strong><code>all_u</code></strong> :&ensp;<code>MDAnalysis.universe</code> <code>object</code></dt>
<dd>The MDA universe object with the proton indicator appended to the
end</dd>
<dt><strong><code>proton_types</code></strong> :&ensp;<code>list</code> of <code>str</code></dt>
<dd>A list of atom types corresponding to the protons that qualify for
the indicator calculations. Protons not in this list that are
connected to the donor residue will be ignored</dd>
<dt><strong><code>acceptor_types</code></strong> :&ensp;<code>list</code> of <code>str</code></dt>
<dd>A list of atom types corresponding to the acceptors that qualify for
the indicator calculations.</dd>
<dt><strong><code>rlist</code></strong> :&ensp;<code>float</code></dt>
<dd>Search radius for looking for acceptor molecules</dd>
</dl>
<p>donor_index:
1-based index for setting the initial donor of the selection.
If this is present, the donor selection will automatically be
set up. Otherwise, it is necessary to manually call another
subroutine to select it</p>
<h2 id="returns">Returns</h2></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">class SelectionsInd2(Selections):
    &#34;&#34;&#34;
    The selection class for indicator 2.

    This class is experimental and may not work as expected due to the fact that
    there was no congnizent equation for indicator 2.
    &#34;&#34;&#34;
    def __init__(self, u, all_u, proton_types, acceptor_types, rlist, donor_index=None, a=None):
        Selections.__init__(self, u, all_u, proton_types, acceptor_types, rlist, donor_index=donor_index, a=a)
        warnings.warn(&#34;SelectionInd2 class is not implemented well&#34;)
        raise NotImplementedError

    def set_donors(self, u, donor_ind):
        self.d = u.select_atoms(&#34;same resnum as bynum %d&#34; % donor_ind)
        self.d = self.d.select_atoms(self.acc_string)

    def set_donor(self, u, donor_ind):
        self.d = u.select_atoms(&#34;bynum %d&#34; % donor_ind)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="adaptive_md_tools.indicator_mda_selections.Selections" href="#adaptive_md_tools.indicator_mda_selections.Selections">Selections</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="adaptive_md_tools.indicator_mda_selections.SelectionsInd2.set_donors"><code class="name flex">
<span>def <span class="ident">set_donors</span></span>(<span>self, u, donor_ind)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>Source code</summary>
<pre><code class="python">def set_donors(self, u, donor_ind):
    self.d = u.select_atoms(&#34;same resnum as bynum %d&#34; % donor_ind)
    self.d = self.d.select_atoms(self.acc_string)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="adaptive_md_tools.indicator_mda_selections.Selections" href="#adaptive_md_tools.indicator_mda_selections.Selections">Selections</a></b></code>:
<ul class="hlist">
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.reset_all" href="#adaptive_md_tools.indicator_mda_selections.Selections.reset_all">reset_all</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.reset_universe_selections" href="#adaptive_md_tools.indicator_mda_selections.Selections.reset_universe_selections">reset_universe_selections</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_acc" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_acc">set_acc</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_all_acc" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_all_acc">set_all_acc</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_all_protons" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_all_protons">set_all_protons</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_dah" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_dah">set_dah</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_donor" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_donor">set_donor</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_one_donor" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_one_donor">set_one_donor</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_original_acc" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_original_acc">set_original_acc</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_proton" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_proton">set_proton</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="adaptive_md_tools" href="index.html">adaptive_md_tools</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="adaptive_md_tools.indicator_mda_selections.Selections" href="#adaptive_md_tools.indicator_mda_selections.Selections">Selections</a></code></h4>
<ul class="">
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.reset_all" href="#adaptive_md_tools.indicator_mda_selections.Selections.reset_all">reset_all</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.reset_universe_selections" href="#adaptive_md_tools.indicator_mda_selections.Selections.reset_universe_selections">reset_universe_selections</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_acc" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_acc">set_acc</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_all_acc" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_all_acc">set_all_acc</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_all_protons" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_all_protons">set_all_protons</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_dah" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_dah">set_dah</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_donor" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_donor">set_donor</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_one_donor" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_one_donor">set_one_donor</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_original_acc" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_original_acc">set_original_acc</a></code></li>
<li><code><a title="adaptive_md_tools.indicator_mda_selections.Selections.set_proton" href="#adaptive_md_tools.indicator_mda_selections.Selections.set_proton">set_proton</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="adaptive_md_tools.indicator_mda_selections.SelectionsInd1" href="#adaptive_md_tools.indicator_mda_selections.SelectionsInd1">SelectionsInd1</a></code></h4>
<ul class="">
<li><code><a title="adaptive_md_tools.indicator_mda_selections.SelectionsInd1.set_proton" href="#adaptive_md_tools.indicator_mda_selections.SelectionsInd1.set_proton">set_proton</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="adaptive_md_tools.indicator_mda_selections.SelectionsInd2" href="#adaptive_md_tools.indicator_mda_selections.SelectionsInd2">SelectionsInd2</a></code></h4>
<ul class="">
<li><code><a title="adaptive_md_tools.indicator_mda_selections.SelectionsInd2.set_donors" href="#adaptive_md_tools.indicator_mda_selections.SelectionsInd2.set_donors">set_donors</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.6.2</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>